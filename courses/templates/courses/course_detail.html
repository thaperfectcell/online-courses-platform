{% extends "base.html" %}

{% block title %}{{ course.title }} ‚Äî –∫—É—Ä—Å{% endblock %}

{% block content %}

<div class="row">
  <div class="col-lg-8">
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-body">
        <h1 class="card-title mb-3">{{ course.title }}</h1>
        <p class="text-muted">
          {{ course.description|linebreaks }}
        </p>
      </div>
    </div>

    <div class="card shadow-sm border-0">
      <div class="card-header bg-white">
        <h5 class="mb-0">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞</h5>
      </div>
      <div class="card-body">
        {% if lessons %}
          <ol class="list-group list-group-numbered">
            {% for lesson in lessons %}
              <li class="list-group-item">
                <h6 class="mb-1">{{ lesson.title }}</h6>
                {% if lesson.description %}
                  <p class="mb-0 text-muted small">
                    {{ lesson.description|truncatechars:160 }}
                  </p>
                {% endif %}
              </li>
            {% endfor %}
          </ol>
        {% else %}
          <p class="text-muted">–£ —ç—Ç–æ–≥–æ –∫—É—Ä—Å–∞ –ø–æ–∫–∞ –Ω–µ—Ç —É—Ä–æ–∫–æ–≤. –î–æ–±–∞–≤—å—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-lg-4 mt-4 mt-lg-0">
    <div class="card shadow-sm border-0 mb-3">
      <div class="card-body">
        <h5 class="card-title">–ó–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å</h5>

        {% if user.is_authenticated %}
          {% if is_enrolled %}
            <div class="alert alert-success py-2">
              –í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç–æ—Ç –∫—É—Ä—Å üéì
            </div>
          {% else %}
            <p class="text-muted small">
              –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å.  
              –í —Ñ–æ–Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Celery.
            </p>
            <form method="post" action="{% url 'courses:enroll' course.pk %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-success w-100">
                –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å
              </button>
            </form>
          {% endif %}
        {% else %}
          <p class="text-muted small mb-2">
            –ß—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.
          </p>
          <a href="{% url 'login' %}?next={{ request.path }}" class="btn btn-outline-primary w-100">
            –í–æ–π—Ç–∏
          </a>
        {% endif %}
      </div>
    </div>

    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h6 class="card-title mb-2">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h6>
        <ul class="list-unstyled small text-muted mb-0">
          <li>ID –∫—É—Ä—Å–∞: {{ course.id }}</li>
          <li>–í—Å–µ–≥–æ —É—Ä–æ–∫–æ–≤: {{ lessons|length }}</li>
        </ul>
      </div>
    </div>
  </div>
</div>

{% endblock %}
